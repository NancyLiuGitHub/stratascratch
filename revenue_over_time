no neg amt

SELECT to_char(created_at::date, 'YYYY-MM') as year_month, ##left(created_at, 7) or date_format(created_at, '%Y-%m')
  avg(sum(purchase_amt)) over (oder by (w) rows between 2 preceding and current row) as pre
 FROM amazon_purchases
 where purchase_amt > 0
 group by 1
 order by 1
  
  
window w as (to_char(created_at::date, 'YYYY-MM'))

SELECT to_char(created_at::date, 'YYYY-MM') as year_month,
  avg(sum(purchase_amt)) over (oder by to_char(created_at::date, 'YYYY-MM') rows between 2 preceding and current row) as pre
 FROM amazon_purchases
 where purchase_amt >= 0
 group by 1
 order by 1
