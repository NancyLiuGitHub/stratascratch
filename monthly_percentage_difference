1) total revenue per month: date(y-m)
2) lag() as pre
3) round((curr-pre)/pre * 100,2)
4) order by date

with monthly_rev as (
SELECT left(created_at, 7) as year_month, sum(value) as curr, lag(sum(value)) over (order by left(created_at, 7)) as prev
FROM sf_transactions
GROUP BY 1 )

SELECT year_month,
  round(100*(curr - prev)/prev,2) as revenue_diff_pct
FROM sf_transactions
ORDER BY year_month

